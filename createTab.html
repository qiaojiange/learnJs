<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>

	<link rel="stylesheet" href="css/table.css" />
	<script type="text/javascript" src="js/doctools.js"></script>
	<script type="text/javascript">
		function createTab() {
			var tabNode = doc.createElement("table");
			tabNode.id = "tableId";
			var rowNode = byName("rownum")[0];
			var colNode = byName("colnum")[0];
			for (var i = 0; i < rowNode.value; i++) {
				var trNode = tabNode.insertRow();
				for (var j = 0; j < colNode.value; j++) {
					var tdNode = trNode.insertCell();
					tdNode.innerHTML = "" + (i + 1) + "...." + (j + 1);
				}
			}
			byTag("div")[0].appendChild(tabNode);
			event.srcElement.disabled = true;
		}
//创建表格
		function createTab1() {
			var tabNode = doc.createElement("table");
			var tbdNode = doc.createElement('tbody');
//			获取行节点
			var trNode = doc.createElement('tr');
			var tdNode = doc.createElement('td');
			var textNode = doc.createTextNode("单元格一");
			tdNode.appendChild(textNode);
			trNode.appendChild(tdNode);
			tbdNode.appendChild(trNode);
			tabNode.appendChild(tbdNode);
			byTag("div")[0].appendChild(tabNode);
		}
//删除行
		function delRow() {
			var tabNode = byId("tableId");
			if (tabNode == null) {
				alert("表格不存在！");
				return false;
			}
			var rownum = byName("delrow")[0].value;
			//			alert(delRow);
			if (rownum > 0 && rownum < tabNode.rows.length) {
				tabNode.deleteRow(rownum - 1);
			} else {
				alert("没有该行，删除不掉!");
			}
		}

//删除列
		function delCol() {
			var tabNode = byId("tableId");
			var colNum = byName("delcol")[0].value;
			alert(colNum);
			if (colNum > 0 && colNum < tabNode.rows[0].cells.length) {
				for (var i = 0; i < tabNode.rows.length; i++) {
					tabNode.rows[i].deleteCell(colNum-1);
				}
			} else {
				alert("没有该列，无法删除！");
			}
		}
	</script>

	<body>
		行：<input type="text" name="rownum" /> &nbsp; 列：
		<input type="text" name="colnum" /><br />
		<input type="button" value="创建表格" onclick="createTab()" />
		<br />

		<input type="text" name="delrow" />
		<input type="button" value="删除行" onclick="delRow()" /><br />

		<input type="text" name="delcol" />
		<input type="button" value="删除列" onclick="delCol()" /><br />
		<div>

		</div>
	</body>

</html>